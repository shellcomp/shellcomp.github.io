<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Shellcomp by shellcomp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Shellcomp</h1>
      <h2 class="project-tagline">Shell autocompletion format</h2>
      <a href="https://github.com/shellcomp/shellcomp/" class="btn">Related projects</a>
      <a href="https://github.com/shellcomp/shellcomp.github.io/issues" class="btn">Feedback and issues</a>
    </section>

    <section class="main-content">
      <h1>
<a id="command-line-completion" class="anchor" href="#command-line-completion" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Command line completion</h1>

<p>Command line (aka tab) completion is popular in the Unix world as it helps typing speed, prevents typos and makes the shell more user-friendly.</p>

<h2>
<a id="the-problem" class="anchor" href="#the-problem" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The problem</h2>

<p>Impementing filename completion is easy. Implementing command-specific completion (e.g. git, apt) is not.</p>

<p>Completion scripts are different across Bash, Zsh and Fish.</p>

<p>Time consuming to implement, sometimes out of date, hacky.
  <a href="https://anonscm.debian.org/cgit/bash-completion/debian.git/tree/completions">examples</a></p>

<h2><a class="anchor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>A modest proposal</h2>

<p>Completion is implemented in the command about to be run:
The shell run the command with a specific <code>--tabcomplete '&lt;partial_string&gt;'</code> option.
The command responds with simple JSON structure that the shell will parse to perform completion or display help messages.</p>

<h2>Benefits:</h2>

<ul>
<li>Shell-independent</li>
<li>Able to suggest alternative commands and provide contextual help</li>
<li>Discoverable: the completion mechanism can be queried programmatically to generate...</li>
<li>...documentation, help commands,</li>
<li>...manpages,</li>
<li>...simple GUIs,</li>
<li>...and functional tests.</li>
</ul>

<h3>
<a id="the-json-format" class="anchor" href="#the-json-format" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The JSON format</h3>

<p>The JSON document is to be printed to stdout; All fields are optional:</p>

<p>v
  version.
completions
  a list of valid completion values with an optional help message.
alt
  alternative completions: other commands that the user might want to use.
help
  contextual help message.</p>

<p>An example response for "git con":</p>

<pre><code>{
    "v": 1,
    "completions": [
        ["config", "get and set repository or global options"],
    ]
    "alt": [
        ["commit", "record changes to repository"]
    ]
    "help": "",
}
</code></pre>

<p><strong>Fields usage:</strong></p>

<p>v
  format version. Should be 1.
completions
  a list of valid completion values in format ["completion string", "help string"]. The help string can be empty. An empty list means that no more arguments are expected. An item with an empty completion string means that non-completable user input is expected (e.g. touch ).
alt
  alternative completions. Some structure as "completions", it contains suggestions about other commands that the user might want to use instead.
  If the 
help
  contextual help message. It can contain newlines or be empty.
errpos
  if the user-supplied string contains a syntax error, this is the position of the first error, counting from 0 from the left.
files
  a list of filenames, in case the current argument is meant to be an existing file. Using a different field other than "completions" allow shells to display the filenames in different colors</p>

<p><strong>How to implement it.</strong></p>

<p>In the long term, popular shells like Bash, Zsh, Fish could implement the standard internally.</p>

<p>In the short term, a simple wrapper could run the application on behalf of the shell and perform "traditional" completion. </p>

<p>Applications could implement completion autonomously or through helper libraries
like <code>DocOpt &lt;http://docopt.org/&gt;</code>_ or <code>Click &lt;http://click.pocoo.org/5/&gt;</code>_</p>

<p>FAQ</p>


      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/shellcomp/shellcomp">Shellcomp</a> is maintained by <a href="https://github.com/shellcomp">shellcomp</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
